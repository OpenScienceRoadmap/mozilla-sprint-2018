<!DOCTYPE html>
<meta charset="utf-8">
<style>

.link {
  stroke: #ccc;
}

.node text {
  pointer-events: none;
  font: 10px sans-serif;
}

</style>
<body>
<script src="//d3js.org/d3.v3.min.js"></script>
<script type="text/javascript">
    const width = 960;
    const height = 500;

    const svg = d3.select('body').append('svg')
        .attr('width', width)
        .attr('height', height);

    const force = d3.layout.force()
        .gravity(0.05)
        .distance(100)
        .charge(-100)
        .size([width, height]);

    d3.json('graph.json', function(error, json) {
        if (error) throw error;

        force.nodes(json.nodes)
            .links(json.links)
            .start();

        const link = svg.selectAll('.link')
            .data(json.links)
            .enter().append('line')
            .attr('class', 'link');

        const node = svg.selectAll('.node')
            .data(json.nodes)
            .enter().append('g')
            .attr('class', 'node')
            .call(force.drag);

        node.append('image')
            .attr('xlink:href', function(d) { return d.image || 'https://upload.wikimedia.org/wikipedia/commons/f/f8/Question_mark_alternate.svg' })
            .attr('x', -16)
            .attr('y', -16)
            .attr('width', 32)
            .attr('height', 32);

        node.append('text')
            .attr('dx', 12)
            .attr('dy', '2em')
            .text(function(d) { return d.name });

        force.on('tick', function() {
            link.attr('x1', function(d) { return d.source.x; })
                .attr('y1', function(d) { return d.source.y; })
                .attr('x2', function(d) { return d.target.x; })
                .attr('y2', function(d) { return d.target.y; });

            node.attr('transform', function(d) { return `translate(${d.x}, ${d.y})`; });
        });
    });
</script>